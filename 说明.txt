修改记录：
1、20150508 将主界面两个DataGrid的属性设置为AllowUpdata False(取消选择)，意在不让该控件由修改和编辑的功能
2、连接数据表
	CADODataSet DataSet;
	DataSet.SetConnection(::GetConnection());
	DataSet.Open(_T("select top 20 * from SampleTable order by ID DESC"));
3.WriteRecord()函数还需要继续完善
4、获得当前时间
	COleDateTime CurrTime;
	CurrTime=CurrTime.GetCurrentTime();
	//CString StrTime;
	//StrTime=CurrTime.Format(_T("%Y-%m-%d %H:%M:%S"));
5、如果需要烟雾判爆，需要增加烟雾记录以及修改WriteRecord()函数
6、CalTestResult()//计算实验结果，爆炸率，可行度等。未完成
7、重锤高度宏定义未完成。
8、需将办公室电脑程序中的实时爆炸率更新和系统复位后清除装药和放捶的功能程序放入本程序20150625。
9、DataGrid更新不及时的解决办法，调用更新之前，使用DataSet.Open()再查询一次。
10、20151021去长沙调试特性落高法逻辑。

版本：20151023 完成增加特性落高法的报表计算。
      1124下班版本

开始摩擦感度设计：
1、播放语音：PlaySound("C:\\BlastTest\\sound\\欢迎使用.wav", NULL, SND_ASYNC | SND_NODEFAULT);
2、20160607长沙调试修改：解决无法修改重锤高度。
3、20160808修改内容：增加两个与PLC通信读写浮点型的函数，修改直接从PLC读取浮点型显示和直接写入浮点型，
    删除通信进程中的PlcData.m_HdyPress.PressFun();//调用液压加压程序。
4、20160812修改写零点不乘10，修改压力设定与显示为两位小数的整形。


/*V1.01 湘电提供的摩擦终版基础上修改
1、把原来摩擦和撞击两个软件，整合成一个软件
2、为适应800*600的屏幕，作了软件界面的修改
3、取消在d盘备份数据的功能
4、解决调试版与Plc通讯的问题
需要解决的问题：出现门控信号没找到，找不到原因 临时取消此功能
V1.03  20170301广西浦北
1、更改烟雾传感器放大倍数(plc程序已经对烟雾数据作了处理)
2、增加了通过mocha.ini判断是摩擦还是撞击的功能，只用编译一次可以同时应用到摩擦与撞击
3、声极计阈值改成显示1位小数，更改后需要重启软件才能生效
4、撞击安装程序中增加质量为5和10的项
不能设定零位的原因暂未找到
V1.04 
1、修改摩擦实时高度没有除以10的bug
2、在试验室运行时仍出现一次  与PLC写入失败！地址：D000000（写入零位出现错误）（不重复出现此问题）
V1.05 屏蔽与PLC写入失败！地址：D000000，写入操作记录
      缩小检测报告、报表窗口大小
	  解决以下问题：从桌面快捷方式启动，找不到报表文件。在文件夹下找文件没有问题
V1.06 
1、撞击增加特性落高法（当时合并的时候，把特性落高法去掉了，）
V1.07
1、解除限制
V1.08 高度不除以10
V1.09 装药完成启动加压(增加了通讯数据)  CMD_JIAYA _T("M0040") 
V1.10 重复设置高度设定值 有的乘10 有的不乘10
V1.11
1、解除对压力超范围，试验无效的限制。
2、对压力值作修正，使显示压力符合要求。
3、设置高度不乘以系数（不知为何系数不为1，导致高度范围不对）

V1.12 
 修复了原来打印报表的一些问题以及可以自动生成试验数据。
因数据结构不合理。仍有一些问题，基本上勉强过关。数据冗余

今天出现的调试过程中出现的问题，搞得自己很恼火。
一开始怀疑程序的问题，也就是程序编译的问题，折腾好一会，原来是因为报表文件不合理。
一般不会想到申报表的问题，因为程序开始运行就报错，根本没有考虑打印报表这个环节。一定要总结经验教训，以后避免犯同类思维定势。


2018年11月27日 周海军

V1.13 2018年12月20日 醴陵 
1、进入模拟模式后，增加调试接口，用以观测实际值，查看模拟效果。
2、摩擦偶尔出现连续 "与PLC通信失败！;屏蔽此消息，改为写日志；
		 
V1.13.01 通过excel输出报表
V1.13.02  调整自动编号的生成顺序
V1.13.03  实验记录，把结果列放在靠前位置
V1.13.04  调整试验结果在excel中显示的顺序。
*/




